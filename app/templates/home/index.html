{% extends "home/home.html" %}
{% import 'home/pagination/home_page.html' as pg %}
{% block css %}
{% endblock %}
{% block content %}
    <!--热门电影-->
    <div class="row">
        <section style="margin-top:5px">
            <div class="container">
                <div class="row">
                    <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                        <!-- Indicators -->
                        <ol class="carousel-indicators">
                            {% for v in preview_data %}
                                {% if v.id==first_preview_id %}
                                    <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
                                {% else %}
                                    <li data-target="#carousel-example-generic" data-slide-to="0"></li>
                                {% endif %}
                            {% endfor %}
                        </ol>
                        <!-- Wrapper for slides -->
                        <div class="carousel-inner" role="listbox">
                            {% for v in preview_data %}
                                {% if v.id==first_preview_id %}
                                    <div class="item active">
                                        <img class="img-responsive center-block"
                                             src="{{ url_for('static',filename="admin/uploads/previews/"+v.cover_picture) }}"
                                             alt="...">
                                        <div class="carousel-caption"></div>
                                    </div>
                                {% else %}
                                    <div class="item">
                                        <img class="img-responsive center-block"
                                             src="{{ url_for('static',filename="admin/uploads/previews/"+v.cover_picture) }}"
                                             alt="...">
                                        <div class="carousel-caption">...</div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                        <!-- Controls -->
                        <a class="left carousel-control" href="#carousel-example-generic" role="button"
                           data-slide="prev">
                            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="right carousel-control" href="#carousel-example-generic" role="button"
                           data-slide="next">
                            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!--热门电影-->
    <!--电影列表-->
    <div class="row" style="margin-top: 5px">
        <div class="container" style="padding-right: 2px;padding-left: 2px">
            <div class="col-md-12 table-responsive" style="padding-left: 0;padding-right: 0;margin-bottom: 8px">
                <table class="table table-bordered" id="movietags"
                       style="margin-bottom: 0px">
                    <!--
                    <tr>
                        <td style="width:10%;">电影分类</td>
                        <td style="width:90%;">
                            <a href="" class="label label-info"><span class="glyphicon glyphicon-tag"></span>&nbsp;电影</a>
                            <a href="" class="label label-default"><span class="glyphicon glyphicon-tag"></span>&nbsp;电视连续剧</a>
                            <a href="" class="label label-danger"><span class="glyphicon glyphicon-tag"></span>&nbsp;音乐MV</a>

                    </tr>
                    -->
                    <tr>
                        <td style="width:10%;">电影标签</td>
                        <td style="width:90%;">
                            <a href="" class="label label-primary"><span class="glyphicon glyphicon-tag"></span>&nbsp;教育</a>
                            <a href="" class="label label-primary"><span class="glyphicon glyphicon-tag"></span>&nbsp;正能量</a>
                            <a href="" class="label label-default"><span class="glyphicon glyphicon-tag"></span>&nbsp;友情</a>
                            <a href="" class="label label-warning"><span class="glyphicon glyphicon-tag"></span>&nbsp;惊悚</a>
                            <a href="" class="label label-danger"><span class="glyphicon glyphicon-tag"></span>&nbsp;亲情</a>
                            <a href="" class="label label-warning"><span class="glyphicon glyphicon-tag"></span>&nbsp;爱情</a>
                            <a href="" class="label label-danger"><span class="glyphicon glyphicon-tag"></span>&nbsp;旅行</a>
                            <a href="" class="label label-primary"><span class="glyphicon glyphicon-tag"></span>&nbsp;体育</a>
                            <a href="" class="label label-info"><span
                                    class="glyphicon glyphicon-tag"></span>&nbsp;美食</a>
                    </tr>
                    <tr>
                        <td>电影评分</td>
                        <td>
                            <a href="" class="label label-primary"><span
                                    class="glyphicon glyphicon-star"></span>&nbsp;</a>
                            <a href="" class="label label-warning"><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span>&nbsp;</a>
                            <a href="" class="label label-info"><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span>&nbsp;</a>
                            <a href="" class="label label-info"><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span>&nbsp;</a>
                            <a href="" class="label label-info"><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span><span
                                    class="glyphicon glyphicon-star"></span>&nbsp;</a>
                        </td>
                    </tr>
                    <tr>
                        <td>发布时间</td>
                        <td>
                            <a href="{{ url_for('home.movie_list',page=1) }}" class="label label-default"><span
                                    class="glyphicon glyphicon-time"></span>&nbsp;最近</span>
                            </a>
                            &nbsp;
                            <a href="{{ url_for('home.movie_list',page=1,id=1) }}" class="label label-default"><span
                                    class="glyphicon glyphicon-time"></span>&nbsp;更早</span>
                            </a>
                        </td>
                    </tr>
                    <tr>
                        <td>播放次数</td>
                        <td>
                            <a href="" class="label label-success"><span
                                    class="glyphicon glyphicon-arrow-down"></span>&nbsp;从高到底</span>
                            </a>
                            &nbsp;
                            <a href="" class="label label-danger"><span
                                    class="glyphicon glyphicon-arrow-up"></span>&nbsp;从低到高</span>
                            </a>
                        </td>
                    </tr>
                    <!--
                    <tr>
                        <td>热门程度</td>
                        <td>
                            <a href="" class="label label-success"><span
                                    class="glyphicon glyphicon-arrow-down"></span>&nbsp;从高到底</span>
                            </a>
                            &nbsp;
                            <a href="" class="label label-danger"><span class="glyphicon glyphicon-arrow-up"></span>&nbsp;从低到高</span>
                            </a>
                        </td>
                    </tr>
                    -->
                </table>
            </div>
        </div>
    </div>
    <div class="row">
        <div id="container">
            {% for v in page_date.items %}
                <div style="padding-left:2px;padding-right:2px" class="col-sm-6 col-md-3">
                    <div class="thumbnail">
                        <img class="lazy" data-src="holder.js/100%x200" alt="100%x200"
                             data-original="/static/admin/uploads/movielogos/{{ v.logo }}" data-holder-rendered="true"
                             style="height: 200px; width: 100%; display: block;">
                        <div class="caption">
                            <h5 style="font-weight: bold">{{ v.title }}</h5>
                            <p style="font-size: 13px">{{ v.info }}</p>
                            <p>
                                <a target="_blank" href="{{ url_for('home.movie_play',id=v.id) }}"
                                   class="btn btn-primary"
                                   role="button">
                                    <span class="glyphicon glyphicon-play"></span>
                                    <span>播放</span>
                                </a>
                                <a onclick="moviecol_add();" href="javascript:;" class="btn btn-danger" role="button"
                                   style="">
                                    <span class="glyphicon glyphicon-heart"></span>&nbsp;
                                    <span id='collect_font'>收藏</span>
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        <div class="col-md-12 text-center" style="margin-top:6px;">
            {{ pg.page(page_date,'home.movie_list') }}
        </div>
        {#        <nav aria-label="Page navigation" class="text-center">#}
        {#            <ul class="pagination" style="margin: 0">#}
        {#                <li>#}
        {#                    <a href="#" aria-label="Previous">#}
        {#                        <span aria-hidden="true">&laquo;</span>#}
        {#                    </a>#}
        {#                </li>#}
        {#                <li class="active"><a href="#">1</a></li>#}
        {#                <li><a href="#">2</a></li>#}
        {#                <li><a href="#">3</a></li>#}
        {#                <li><a href="#">4</a></li>#}
        {#                <li><a href="#">5</a></li>#}
        {#                <li>#}
        {#                    <a href="#" aria-label="Next">#}
        {#                        <span aria-hidden="true">&raquo;</span>#}
        {#                    </a>#}
        {#                </li>#}
        {#            </ul>#}
        {#        </nav>#}
    </div>
    <!--电影列表-->
{% endblock %}
{% block copyright %}
    <!--版权-->
    <!-- <div class="col-md-12  text-center wow animate__animated animate__backInDown animate__delay-2s"-->
    <div class="col-md-12  text-center wow animate__animated animate__fadeIn"
         style="padding: 25px 0 25px;background: brown;margin-top: 8px">
        <p style="margin: 0">
            <a href="{{ url_for('home.about_website') }}" style="color:white;font-weight: bold">关于本站</a>&nbsp;&nbsp;
            <a href="{{ url_for('home.disclaimer') }}" style="color:white;font-weight: bold">免责申明</a>&nbsp;&nbsp;
            <a href="{{ url_for('home.contact') }}" style="color:white;font-weight: bold">联系我们</a>&nbsp;&nbsp;
            <a href="{{ url_for('home.blueprint') }}" style="color:white;font-weight: bold">本站蓝图</a>&nbsp;&nbsp;
        </p>
        <p style="margin: 0">
            <span style="color: white;font-weight: bold">Copyright © 2020-2022&nbsp; d5video.pythoneers.cn. All Rights Reserved.</span>
        </p>
        <p style="margin: 0">
            <a target="_blank_" href="http://www.miit.gov.cn/"
               style="color:white;font-weight: bold">豫ICP备19037971号</a>
            <a target="_blank">
                <img src="/static/home/imgs/beian.png" style="padding-bottom:6px">
                <span style="color:white;font-weight: bold">豫公网安备 41152802000091号</span>
            </a>
            <!--<span>版本号:1.1.0.190402_alpha</span>-->
            <span>
             <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
             document.write(unescape("%3Cspan id='cnzz_stat_icon_1278138602'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1278138602%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
            <span id="cnzz_stat_icon_1278138602"></span>
            <script src="http://s4.cnzz.com/z_stat.php?id=1278138602&amp;show=pic" type="text/javascript"></script>
            <script src="http://c.cnzz.com/core.php?web_id=1278138602&amp;show=pic&amp;t=z" charset="utf-8"
                    type="text/javascript">
            </script>
    </span>
        </p>
    </div>
    <!--/版权-->
{% endblock %}
{% block js %}
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery_lazyload/1.9.7/jquery.lazyload.js"></script>
    <script>
        $('#nav-movie').css({'color': '#a52a2a'})
        $("img.lazy").lazyload({
            //threshold : 200 //想提前加载图片, 可以设置threshold 选项, 设置 threshold 为 200 令图片在距离屏幕 200 像素时提前加载.
            //event : "click"//你可以使用jquery事件，例如click和mouseover。也可以使用自定义事件，如sporty、foobar默认情况下是要等到用户向下滚动并且图像出现在视口中时。只有当用户点击它们才加载图片：
            effect: "fadeIn" //淡入效果
        });
    </script>
    <script>
        $(function () {
            get_movie_list();
            //获取电影收藏状态
            get_moviecol_status();
        })

        function get_movie_list() {
            $.ajax({
                url: '/api/movie/list/',
                type: 'GET',
                datatype: 'json',
                //data: {},
                success: function (args) {
                    $.each(args.movies, function (i, row) {
                        var movies_items = "<div style=\"padding-left:2px;padding-right:2px\" class=\"col-sm-6 col-md-3\"><div class=\"thumbnail\">" + "<img class=\"lazy\" data-src=\"holder.js/100%x200\" alt=\"100%x200\"" + "data-original=\"" + "/static/admin/uploads/movielogos/" + row.logo + "\"" + "data-holder-rendered=\"true\"" + "style=\"height: 200px; width: 100%; display: block;\">" + "<div class=\"caption\">" + "<h5 style=\"font-weight: bold\">" + row.title + "</h5>" + "<p style=\"font-size: 13px\">" + "" + row.info + "" + "</p>" + "<p>" + "<a href=\"/play/" + row.id + ".html\" class=\"btn btn-primary\" role=\"button\">" + "<span class=\"glyphicon glyphicon-play\"></span>" + "<span>播放</span>" + "</a>" + "<a onclick=\"moviecol_add();\" href=\"javascript:;\" class=\"btn btn-danger\" role=\"button\"" + "style=\"\">" + "<span class=\"glyphicon glyphicon-heart\"></span>&nbsp;" + "<span id='collect_font'>收藏</span></a>" + "</p>" + "</div>" + "</div></div>"
                        $('#container').append(movies_items);
                    });
                    $("img.lazy").lazyload({
                        //threshold : 200 //想提前加载图片, 可以设置threshold 选项, 设置 threshold 为 200 令图片在距离屏幕 200 像素时提前加载.
                        //event : "click"//你可以使用jquery事件，例如click和mouseover。也可以使用自定义事件，如sporty、foobar默认情况下是要等到用户向下滚动并且图像出现在视口中时。只有当用户点击它们才加载图片：
                        effect: "fadeIn" //淡入效果
                    });
                }
            })
        }

        function moviecol_add() {
            $.ajax({
                url: '/moviecol/add/',
                type: 'GET',
                datatype: 'json',
                data: {
                    'user_id':{{ session.get('user_id')}},
                },
                success: function (arg) {
                    if (arg.ok) {
                        alert('success');
                    }
                }
            })
        }

        function get_moviecol_status() {
            var user_id = {{ session.get('user_id') }};
            var movie_id = 1;
            $.ajax({
                url: '/api/moviecol/status/',
                dataType: 'json',
                data: {
                    'user_id': user_id,
                    'movie_id': movie_id
                },
                type: 'GET',
                success: function (arg) {
                    if (arg.ok) {
                        $('#collect_font').text('已收藏')
                        //alert('已经收藏过了，不需要再次操作！！')
                    } else {
                        $('#collect_font').text('收藏')
                        //alert('收藏成功')
                    }
                }
            })
        }

    </script>
{% endblock %}